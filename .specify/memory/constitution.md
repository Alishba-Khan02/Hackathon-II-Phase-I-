<!--
Sync Impact Report:
- Version change: 0.0.0 → 1.0.0
- List of modified principles: Initial creation
- Added sections: 9 initial principles
- Removed sections: None
- Templates requiring updates:
  - ✅ .specify/templates/plan-template.md
  - ✅ .specify/templates/spec-template.md
  - ✅ .specify/templates/tasks-template.md
- Follow-up TODOs:
  - TODO(RATIFICATION_DATE): Set the initial ratification date.
-->
# Evolution of Todo (CLI → Cloud-Native AI System) Constitution

## 1. Purpose (WHY)

This project exists to demonstrate disciplined Spec-Driven Development (SDD) using AI agents.
The goal is to evolve a Todo application from a simple in-memory CLI into a distributed, cloud-native, AI-powered system, without manual coding.

All implementation must be traceable, reviewable, and spec-authorized.

## 2. Absolute Rules (NON-NEGOTIABLE)

No code may be written without an approved Spec-Kit task.

All development follows this lifecycle only:
Constitution → Specify → Plan → Tasks → Implement

Manual coding is forbidden. Code must be generated by Gemini. Humans may only edit specifications, never source files.

If a requirement is unclear → STOP. Update the spec. Do not infer or improvise behavior.

## 3. Architectural Principles

### 3.1 Evolutionary Design
- Each phase builds on the previous.
- No phase may be skipped.
- Refactors must preserve prior functionality.

### 3.2 Stateless First
- Servers must be stateless from Phase III onward.
- All state lives in a database, Dapr state store, or event stream.

### 3.3 API-First & Tool-Driven
- All business logic is exposed via:
  - REST APIs (Phase II)
  - MCP tools (Phase III+)
- AI agents never access the database directly.

### 3.4 Event-Driven by Default (Phase V)
- Side effects (reminders, recurring tasks, audit logs) must be async.
- Kafka (or Kafka-compatible) is the system backbone.

## 4. Technology Constraints (IMMUTABLE)

### 4.1 Core Stack
| Layer      | Technology           |
|------------|----------------------|
| Language   | Python 3.13+         |
| Backend    | FastAPI              |
| ORM        | SQLModel             |
| Frontend   | Next.js (App Router) |
| AI         | OpenAI Agents SDK    |
| Chat UI    | OpenAI ChatKit       |
| MCP        | Official MCP SDK     |
| Database   | Neon PostgreSQL      |
| Auth       | Better Auth (JWT)    |

### 4.2 Cloud & Infra
| Area        | Technology                        |
|-------------|-----------------------------------|
| Local K8s   | Minikube                          |
| Cloud K8s   | DigitalOcean Kubernetes (DOKS)    |
| Packaging   | Docker + Helm                     |
| AI DevOps   | Gordon, kubectl-ai, Kagent        |
| Runtime     | Dapr                              |
| Messaging   | Kafka / Redpanda                  |

Changing this stack requires a Constitution amendment.

## 5. Phase Governance

- **Phase I – CLI (In-Memory):** No database, no web, no AI. Pure Python console app.
- **Phase II – Web App:** REST APIs only, persistent storage (PostgreSQL), JWT-based auth, multi-user isolation enforced.
- **Phase III – AI Chatbot:** MCP tools are the only way AI mutates state. Chat endpoint must be stateless. Conversation state persisted externally.
- **Phase IV – Local Kubernetes:** Dockerized services, Helm-based deployment, Minikube only.
- **Phase V – Cloud-Native Advanced:** Kafka-driven architecture, Dapr for pub/sub, state, jobs, secrets. Cloud Kubernetes deployment, CI/CD enabled.

## 6. AI Agent Rules (Gemini)

AI agents MUST:
- Read Constitution before any action.
- Refuse to generate code without task IDs.
- Reference specs explicitly.
- Ask for spec updates instead of guessing.
- Generate infrastructure from specs (Helm, Dapr, K8s).
- Preserve backward compatibility unless spec says otherwise.

AI agents MUST NOT:
- Invent features.
- Modify schemas silently.
- Bypass MCP tools.
- Embed secrets in code.
- Collapse phases or merge responsibilities.

## 7. Quality & Verification Standards

- Every feature must have a user story, acceptance criteria, and a Tool/API definition.
- Every service must be restart-safe and horizontally scalable.
- Every side effect must be observable (logs/events) and reproducible.

## 8. Security Principles

- JWT required for all non-public APIs.
- User isolation enforced at the API level, MCP tool level, and database query level.
- Secrets stored via Kubernetes Secrets or a Dapr secret store.

## 9. Definition of Done

A phase is considered complete only if:
- All specs exist and are versioned.
- All code maps to tasks.
- The application runs successfully.
- The required deployment target is live.
- Stateless restart is verified.
- Features work end-to-end.

## Governance

- **Hierarchy of Authority:** Constitution > Specify > Plan > Tasks > Code

**Version**: 1.0.0 | **Ratified**: TODO(RATIFICATION_DATE): Set the initial ratification date. | **Last Amended**: 2025-12-30