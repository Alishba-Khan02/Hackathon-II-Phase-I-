---
id: 1
title: Create Initial Project Constitution
stage: constitution
date: 2025-12-30
surface: agent
model: gemini-2.5-flash
feature: none
branch: main
user: User
command: /sp.constitution
labels: [constitution, setup]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files:
  - .specify/memory/constitution.md
  - .specify/templates/plan-template.md
  - .gemini/commands/sp.constitution.toml
tests:
  - none
---

## Prompt

/sp.constitution Project: Evolution of Todo (CLI ‚Üí Cloud-Native AI System)

1. Purpose (WHY)

This project exists to demonstrate disciplined Spec-Driven Development (SDD) using AI agents.
The goal is to evolve a Todo application from a simple in-memory CLI into a distributed, cloud-native, AI-powered system, without manual coding.

All implementation must be traceable, reviewable, and spec-authorized.

2. Absolute Rules (NON-NEGOTIABLE)

No code may be written without an approved Spec-Kit task

All development follows this lifecycle only:

Constitution ‚Üí Specify ‚Üí Plan ‚Üí Tasks ‚Üí Implement


Manual coding is forbidden

Code must be generated by Claude Code or Gemini

Humans may only edit specifications, never source files

If a requirement is unclear ‚Üí STOP

Update the spec

Do not infer or improvise behavior

Hierarchy of Authority

Constitution > Specify > Plan > Tasks > Code

3. Architectural Principles
3.1 Evolutionary Design

Each phase builds on the previous

No phase may be skipped

Refactors must preserve prior functionality

3.2 Stateless First

Servers must be stateless from Phase III onward

All state lives in database, Dapr state store, or event stream

3.3 API-First & Tool-Driven

All business logic is exposed via:

REST APIs (Phase II)

MCP tools (Phase III+)

AI agents never access the database directly

3.4 Event-Driven by Default (Phase V)

Side effects (reminders, recurring tasks, audit logs) must be async

Kafka (or Kafka-compatible) is the system backbone

4. Technology Constraints (IMMUTABLE)
4.1 Core Stack
Layer	Technology
Language	Python 3.13+
Backend	FastAPI
ORM	SQLModel
Frontend	Next.js (App Router)
AI	OpenAI Agents SDK
Chat UI	OpenAI ChatKit
MCP	Official MCP SDK
Database	Neon PostgreSQL
Auth	Better Auth (JWT)
4.2 Cloud & Infra
Area	Technology
Local K8s	Minikube
Cloud K8s	DigitalOcean Kubernetes (DOKS)
Packaging	Docker + Helm
AI DevOps	Gordon, kubectl-ai, Kagent
Runtime	Dapr
Messaging	Kafka / Redpanda

Changing this stack requires a Constitution amendment.

5. Phase Governance
Phase I ‚Äì CLI (In-Memory)

No database

No web

No AI

Pure Python console app

Phase II ‚Äì Web App

REST APIs only

Persistent storage (PostgreSQL)

JWT-based auth

Multi-user isolation enforced

Phase III ‚Äì AI Chatbot

MCP tools are the only way AI mutates state

Chat endpoint must be stateless

Conversation state persisted externally

Phase IV ‚Äì Local Kubernetes

Dockerized services

Helm-based deployment

Minikube only

Phase V ‚Äì Cloud-Native Advanced

Kafka-driven architecture

Dapr for pub/sub, state, jobs, secrets

Cloud Kubernetes deployment

CI/CD enabled

6. AI Agent Rules (Gemini / Claude)

AI agents MUST:

Read Constitution before any action

Refuse to generate code without task IDs

Reference specs explicitly

Ask for spec updates instead of guessing

Generate infrastructure from specs (Helm, Dapr, K8s)

Preserve backward compatibility unless spec says otherwise

AI agents MUST NOT:

Invent features

Modify schemas silently

Bypass MCP tools

Embed secrets in code

Collapse phases or merge responsibilities

7. Quality & Verification Standards

Every feature must have:

User story

Acceptance criteria

Tool/API definition

Every service must be:

Restart-safe

Horizontally scalable

Every side effect must be:

Observable (logs/events)

Reproducible

8. Security Principles

JWT required for all non-public APIs

User isolation enforced at:

API level

MCP tool level

Database query level

Secrets stored via:

Kubernetes Secrets or

Dapr secret store

9. Definition of Done

A phase is considered complete only if:

All specs exist and are versioned

All code maps to tasks

Application runs successfully

Required deployment target is live

Stateless restart is verified

Features work end-to-end

## Response snapshot

I have successfully updated the project constitution and propagated the necessary changes to the project templates.

- **New Version**: 1.0.0 (Initial creation)
- **Manual Follow-up**:
  - `TODO(RATIFICATION_DATE)` in `.specify/memory/constitution.md`: Please set the initial ratification date.
- **Suggested Commit Message**: `docs: amend constitution to v1.0.0 (initial creation)`

## Outcome

- ‚úÖ Impact: The project constitution was created and initialized.
- üß™ Tests: none
- üìÅ Files: .specify/memory/constitution.md, .specify/templates/plan-template.md, .gemini/commands/sp.constitution.toml
- üîÅ Next prompts: none
- üß† Reflection: The process of updating the constitution and propagating the changes to the templates was successful.

## Evaluation notes (flywheel)

- Failure modes observed: none
- Graders run and results (PASS/FAIL): PASS
- Prompt variant (if applicable): null
- Next experiment (smallest change to try): null
